<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) 2007-2010 Nokia Corporation and/or its subsidiary(-ies) All rights reserved. -->
<!-- This component and the accompanying materials are made available under the terms of the License 
"Eclipse Public License v1.0" which accompanies this distribution, 
and is available at the URL "http://www.eclipse.org/legal/epl-v10.html". -->
<!-- Initial Contributors:
    Nokia Corporation - initial contribution.
Contributors: 
-->
<!DOCTYPE task
  PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="GUID-9E3452F2-1DCB-4DEC-A8F1-CCE7A62CBD61" xml:lang="en"><title>Enabling
MTP over Bluetooth in the initiator driven mode</title><shortdesc>This tutorial describes how to start the MTP over Bluetooth service
in initiator driven mode.</shortdesc><prolog><metadata><keywords/></metadata></prolog><taskbody>
<context>       <p>In the initiator-driven mode a request for MTP data transfer
is made by the host PC (the initiator). However, the MTP over Bluetooth service
on the Symbian device (the responder) must be started (by an MTP client application)
before the initiator can make its request. </p>     </context>
<steps id="GUID-4DD07DEC-6017-4237-BE46-1D69E5FBD744-GENID-1-7-1-23-1-1-7-1-6-1-5-1-5-1-3-2">
<step id="GUID-9A69E5AD-E938-4092-A8C2-CB65C37C8962-GENID-1-7-1-23-1-1-7-1-6-1-5-1-5-1-3-2-1"><cmd>The user application
must instantiate a service provider, RMTPClient, and connect to the MTP Server. </cmd>
</step>
<step id="GUID-0C01583A-3F0C-474B-9AEC-430D2DDFF8A4-GENID-1-7-1-23-1-1-7-1-6-1-5-1-5-1-3-2-2"><cmd>Once the session
between the MTP Client and the MTP Server is connected the MTP Client calls
StartTransport() to ask the MTP Server to load the MTP Bluetooth Transport
plug-in. The UID for the Bluetooth Transport plug-in, 0x10286FCB, is passed
to this method.  </cmd>
<stepxmp><codeblock xml:space="preserve">RMTPClient mtp;
TInt error(KErrNone) ;

error = mtp.Connect() ;
if ( KErrNone == error )
    {
    // Start the bluetooth transport.
    error = mtp.StartTransport( KBTMTPClientUID ) ;
    if( error != KErrNone )
       {
       // Error starting Bluetooth transport.
       }
...
</codeblock></stepxmp>
<info><p>The MTP transport can be stopped as follows:  </p></info>
<stepxmp><codeblock xml:space="preserve">error = mtp.StopTransport( KBTMTPClientUID ) ; 
if( error != KErrNone )
   {
   // Error stopping Bluetooth transport.
   }

mtp.Close()
</codeblock></stepxmp>
</step>
</steps>
<result>       <p>The MTP service is started on the device, and the MTP connection
between the device and the host PC is established.  </p><p>Once the MTP service
is started on the device the host PC can request the MTP connection with it.
Usually, the host PC sends an SDP query to discover if the remote device supports
the MTP Responder Service. If it does, the host PC establishes the MTP over
Bluetooth connection with the device through the Bluetooth Stack.  </p>  
  </result>
</taskbody><related-links>
<link href="GUID-2247D2A7-5A68-558C-9919-F62C9BCA5B24.dita"><linktext>Enabling
MTP over Bluetooth Tutorial</linktext></link>
</related-links></task>