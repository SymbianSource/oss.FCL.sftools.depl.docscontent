<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) 2007-2010 Nokia Corporation and/or its subsidiary(-ies) All rights reserved. -->
<!-- This component and the accompanying materials are made available under the terms of the License 
"Eclipse Public License v1.0" which accompanies this distribution, 
and is available at the URL "http://www.eclipse.org/legal/epl-v10.html". -->
<!-- Initial Contributors:
    Nokia Corporation - initial contribution.
Contributors: 
-->
<!DOCTYPE concept
  PUBLIC "-//OASIS//DTD DITA Concept//EN" "concept.dtd">
<concept id="GUID-4263CC05-EF13-5A2C-875C-72F3C2F6AB57" xml:lang="en"><title>Reading
Email Messages Using the Rich Text API</title><prolog><metadata><keywords/></metadata></prolog><conbody>
<p>This tutorial explains how to read email messages using the rich text API. </p>

<section><title>Introduction</title> <p>You can download and store email messages
using any of the following interfaces, and read them using the <xref href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.dita"><apiname>CRichText</apiname></xref> API. </p> <ul>
<li id="GUID-924CB365-C6D7-5A06-AA8C-0B183F630149"><p> <xref href="GUID-6A4CAFB0-262A-3721-B91B-07F2C3B64B5F.dita"><apiname>CMsvPlainBodyText</apiname></xref>  </p> </li>
<li id="GUID-102EC633-14C4-5CDE-B56A-E2F6800B928B"><p> <xref href="GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.dita"><apiname>CImPlainBodyText</apiname></xref>  </p> </li>
<li id="GUID-27705FA3-83E7-5A41-8439-DD29CBBFA12E"><p> <xref href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.dita"><apiname>CRichText</apiname></xref>  </p> </li>
</ul> </section>
<section><title>Procedure</title><p>To read an email message using the CRichText
class, complete the following steps: </p><ol>
<li id="GUID-EFDB277B-D0A7-42E8-B337-02CA737B4F72"><p>Use the <codeph>TMsvId aMessageId</codeph> parameter of the downloaded
email to create the <xref href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.dita"><apiname>CMsvEntry</apiname></xref> class. </p></li>
<li id="GUID-94010CC4-603E-46DA-B691-355758A13C24"><p>Use the <xref href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.dita"><apiname>CMsvEntry</apiname></xref> class to create the <xref href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.dita"><apiname>CImEmailMessage</apiname></xref> object
class.</p></li>
<li id="GUID-FFB38DCA-0805-454E-88F1-2B6505A16710"><p>Use the <xref href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.dita#GUID-323E701E-EA22-3CC8-AE84-C16880608D44/GUID-57CA3F50-33EA-359B-AABB-4E4E15AF2A18"><apiname>CImEmailMessage::GetBodyTextL()</apiname></xref> function
to get the body text in the <xref href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.dita"><apiname>CRichText</apiname></xref> class.</p></li>
</ol></section>
</conbody><related-links>
<link href="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC.dita"><linktext>Chunk Method
to Process Emails</linktext></link>
<link href="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7.dita"><linktext>Imap4Example:
An Email manager using IMAP4 and SMTP</linktext></link>
<link href="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC.dita"><linktext>Pop3Example:
An Email manager using POP3 and SMTP</linktext></link>
</related-links></concept>